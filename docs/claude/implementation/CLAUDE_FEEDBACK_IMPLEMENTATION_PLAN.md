# Claude Code (Opus 4) - ユーザーフィードバック実装計画

**作成日**: 2025-07-25  
**基づく情報**: ユーザーフィードバックとレビュアーコメント  
**目的**: Task 10.4 の実用性向上とユーザーエクスペリエンス最適化

## 🎯 実装優先順位

### Phase 1: 即座実装改善 (★マーク - 次リリース)

#### A. 既読ボタンのフェードアウト効果
- **実装難易度**: 小（CSS追加のみ）
- **効果**: 大（視覚的フィードバックによる満足度向上）
- **実装方法**:
  - 既読ボタン押下時にメンション行を半透明化
  - 1秒後に非表示にするアニメーション
- **推定時間**: 1時間

#### B. /todo表示の分割
- **実装難易度**: 中
- **効果**: 大（情報の整理による認知負荷軽減）
- **実装方法**:
  - [TASKS]セクションと[MENTIONS]セクションを分離
  - それぞれ独立したBlock Kitセクションとして表示
  - メンション対応済みのものは自動的に非表示
- **推定時間**: 3時間

#### C. スレッドジャンプの1クリック化
- **実装難易度**: 小
- **効果**: 中（操作ステップの削減）
- **実装方法**:
  - 現在の「スレッドで返信する」ボタンを直接permalinkボタンに変更
  - 中間の確認画面をスキップ
- **推定時間**: 1時間

**Phase 1 合計**: 5時間

### Phase 2: 次作業セッション改善

#### D. タスク重複防止
- **実装難易度**: 中
- **効果**: 大（データ整合性の向上）
- **実装方法**:
  - slackTs + channelIdでUNIQUE制約を追加
  - 既存タスクがある場合はupsert（更新）処理
  - ただし、完了済みタスクの再作成は許可
- **推定時間**: 2時間

#### E. スレッド内メンション検知
- **実装難易度**: 小
- **効果**: 中（メンション検知の完全性向上）
- **実装方法**:
  - event.thread_tsの対応
  - 二重insert防止
- **推定時間**: 1時間

**Phase 2 合計**: 3時間

### Phase 3: 長期計画改善 (☆マーク - 別タスク化)

#### F. User Tokenオプトイン実装
- **実装難易度**: 大
- **効果**: 大（72時間履歴検索の実現）
- **方針**:
  - 「接続すれば/mentionが72h分リッチになる」という価値訴求
  - Phase 1.5として別タスク化
  - OAuth、Token保持、失効時リフレッシュをまとめて設計
- **推定時間**: 8時間（別タスクとして計画）

#### G. タスク完了→既読自動反映
- **実装難易度**: 中
- **効果**: 中（ワークフローの自動化）
- **実装方法**:
  - タスク完了時に関連メンションを既読に更新
- **推定時間**: 2時間（別タスクとして計画）

## 📅 実装スケジュール提案

### Week 1: Phase 1 実装
- **Day 1**: 既読ボタンフェードアウト + スレッドジャンプ1クリック化 (2時間)
- **Day 2-3**: /todo表示分割 (3時間)
- **Day 4**: 統合テスト・品質確認 (1時間)

### Week 2: Phase 2 + 仕様準拠
- **Day 1**: タスク重複防止 + スレッド内メンション検知 (3時間)
- **Day 2**: Task 10.9 `/mention`コマンド仕様準拠 (2時間)
- **Day 3**: Task 10.10 Block UIテキスト仕様準拠 (3時間)
- **Day 4**: Task 10.12 旧システム削除 (1時間)

### Week 3: 統合・品質向上
- **統合テスト**: 全機能の動作確認
- **パフォーマンス最適化**: レスポンス時間改善
- **エラーハンドリング強化**: エッジケース対応

## 🤝 Kiro との連携ポイント

### 情報共有が必要な改善
1. **タスク重複防止**: データベーススキーマ変更の調整
2. **User Tokenオプトイン**: OAuth Token Management (Task 3) との統合
3. **/todo表示分割**: 既存のタスク表示機能との整合性確認

### 並行作業での注意点
- **データベース変更**: Kiro の Task 3 (OAuth) と調整
- **UI一貫性**: Block Kit コンポーネントの統一
- **エラーハンドリング**: 共通エラー処理パターンの維持

## 📊 成功指標

### ユーザーエクスペリエンス
- **操作ステップ削減**: スレッドジャンプ 2クリック → 1クリック
- **視覚的フィードバック**: 既読操作の即座な反応
- **情報整理**: タスクとメンションの明確な分離

### 技術的品質
- **データ整合性**: タスク重複の完全防止
- **検知完全性**: スレッド内メンションの漏れなし検知
- **パフォーマンス**: 応答時間の維持・改善

### 仕様準拠
- **QRMVP-JP-1.0**: 100%準拠達成
- **Block UI**: 正確な文言・レイアウト
- **コマンド動作**: 仕様通りの動作確認

## 🔄 フィードバックループ

### 実装後の検証
1. **機能動作確認**: 各改善項目の動作テスト
2. **ユーザビリティ**: 実際の使用感の確認
3. **パフォーマンス**: レスポンス時間の測定
4. **統合性**: 他機能との連携確認

### 継続的改善
- **ユーザーフィードバック**: 実装後の使用感収集
- **メトリクス監視**: 使用パターンの分析
- **品質指標**: エラー率・満足度の追跡

この計画により、ユーザーフィードバックに基づく実用的な改善を段階的に実装し、Task 10.4 を真に使いやすいシステムに進化させます。